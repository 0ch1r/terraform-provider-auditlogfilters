---
page_title: "auditlogfilter_user_assignment Resource - Audit Log Filter"
subcategory: ""
description: |-
  Manages user assignments to audit log filters using the audit_log_filter component.
  This resource allows you to assign users to specific audit log filters, enabling targeted auditing for different users. The user can be specified with a username and host pattern, or use '%' for the default filter assignment.
---

# auditlogfilter_user_assignment (Resource)

Manages user assignments to audit log filters using the audit_log_filter component.

This resource allows you to assign users to specific audit log filters, enabling targeted auditing for different users. The user can be specified with a username and host pattern, or use '%' for the default filter assignment.

## Example Usage

### Assign Filter to Specific User

```terraform
resource "auditlogfilter_filter" "connection_audit" {
  name = "connection_events"
  definition = jsonencode({
    filter = {
      class = {
        name = "connection"
        event = {
          name = ["connect", "disconnect"]
        }
      }
    }
  })
}

resource "auditlogfilter_user_assignment" "app_user" {
  username    = "app_user"
  userhost    = "%.example.com"
  filter_name = auditlogfilter_filter.connection_audit.name
}
```

### Default Filter Assignment

```terraform
resource "auditlogfilter_user_assignment" "default_filter" {
  username    = "%"
  userhost    = "%"
  filter_name = auditlogfilter_filter.connection_audit.name
}
```

### Admin User Assignment

```terraform
resource "auditlogfilter_user_assignment" "admin_audit" {
  username    = "admin"
  userhost    = "localhost"
  filter_name = "comprehensive_admin_filter"
}
```

### Multiple User Assignments

```terraform
resource "auditlogfilter_filter" "production_audit" {
  name = "production_access"
  definition = jsonencode({
    filter = {
      class = {
        name = "table_access"
        database = {
          name = "production"
        }
      }
    }
  })
}

resource "auditlogfilter_user_assignment" "production_users" {
  for_each = toset(["app_user1", "app_user2", "data_analyst"])
  
  username    = each.value
  userhost    = "%"
  filter_name = auditlogfilter_filter.production_audit.name
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `filter_name` (String) Name of the audit log filter to assign to the user. The filter must exist.
- `username` (String) MySQL username to assign the filter to. Use '%' for default assignment.

### Optional

- `userhost` (String) Host pattern for the user assignment. Use '%' to match any host. This is combined with username to form the complete user specification.

### Read-Only

- `id` (String) Unique identifier for the user assignment (username@userhost).

## Import

User assignments can be imported using the user specification (username@userhost):

```shell
# Import specific user assignment
terraform import auditlogfilter_user_assignment.example "username@hostname"

# Import default assignment
terraform import auditlogfilter_user_assignment.default "%"

# Import user with wildcard host
terraform import auditlogfilter_user_assignment.app_user "app_user@%"
```

## User Specification Format

User assignments use MySQL's user specification format:

### Username Patterns
- **Specific user**: `"app_user"` - Matches only the user named "app_user"
- **Default assignment**: `"%"` - Matches all users who don't have a specific assignment

### Host Patterns  
- **Any host**: `"%"` - Matches connections from any host
- **Specific host**: `"localhost"` - Matches only localhost connections
- **Domain pattern**: `"%.example.com"` - Matches any host in the example.com domain
- **IP pattern**: `"192.168.1.%"` - Matches any IP in the 192.168.1.x subnet

### Combined Examples
- `username = "admin", userhost = "localhost"` → `admin@localhost`
- `username = "app", userhost = "%.prod.com"` → `app@%.prod.com`  
- `username = "%", userhost = "%"` → `%` (default assignment)

## Important Considerations

### Assignment Priority

MySQL applies audit log filter assignments in this order:
1. Most specific user@host match
2. User with wildcard host (`user@%`)
3. Default assignment (`%`)

### Filter Dependencies

User assignments require the referenced filter to exist:
- The `filter_name` must match an existing audit log filter
- If the filter is deleted, associated user assignments are automatically removed
- Use `depends_on` or resource references to ensure proper ordering

### Session Impact

- New assignments take effect for new connections
- Existing sessions continue using their current filter until reconnection
- Changing assignments may require users to reconnect to pick up new filters

### Default Assignments

The special username `"%"` creates a default assignment:
- Applied to users who don't have a specific assignment
- Useful for organization-wide audit policies
- Can be overridden by more specific user assignments

## Common Usage Patterns

### Role-Based Assignments

```terraform
# Admin users get comprehensive auditing
resource "auditlogfilter_user_assignment" "admins" {
  for_each = toset(["admin1", "admin2", "dba"])
  
  username    = each.value
  userhost    = "%"
  filter_name = "comprehensive_admin_audit"
}

# Application users get basic connection auditing
resource "auditlogfilter_user_assignment" "app_users" {
  for_each = toset(["app_prod", "app_staging"])
  
  username    = each.value
  userhost    = "%.app.internal"
  filter_name = "basic_connection_audit"
}

# Default for everyone else
resource "auditlogfilter_user_assignment" "default" {
  username    = "%"
  userhost    = "%"
  filter_name = "minimal_audit"
}
```

### Environment-Specific Assignments

```terraform
# Production environment gets full auditing
resource "auditlogfilter_user_assignment" "production" {
  username    = "prod_user"
  userhost    = "%.production.internal"
  filter_name = "full_audit_filter"
}

# Development environment gets minimal auditing
resource "auditlogfilter_user_assignment" "development" {
  username    = "dev_user"
  userhost    = "%.development.internal"
  filter_name = "dev_audit_filter"
}
```

### Compliance-Based Assignments

```terraform
# PCI compliance requires comprehensive auditing for payment app
resource "auditlogfilter_user_assignment" "pci_compliance" {
  username    = "payment_app"
  userhost    = "%.secure.internal"
  filter_name = "pci_compliance_audit"
}

# GDPR compliance for user data access
resource "auditlogfilter_user_assignment" "gdpr_compliance" {
  username    = "user_data_service"
  userhost    = "%"
  filter_name = "gdpr_audit_filter"
}
```
